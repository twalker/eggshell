doctype html
html
  head
    title #{title} v#{settings.version} (#{settings.env})
    link(rel='stylesheet', href='/css/style.css')

    script(src='/js/src/bower_components/traceur/traceur.js')
    //-
      script(src='/js/src/es6-module-loader.js')
    script(src='/js/src/system.js')

    script.
      require = requirejs = System.require;
      System.baseURL = '/js/src/';
      //System.map[''] = '';

      System.map['jquery'] = 'bower_components/jquery/dist/jquery';
      System.map['underscore'] = 'bower_components/lodash/dist/lodash';
      System.map['backbone'] = 'bower_components/backbone/backbone';
      System.map['mustache'] = 'bower_components/mustache/mustache';

      /*
      System.import('flyweight').then(function(fly){
        console.log('hello', fly)
      }, function(err){
        console.log('error', err)
      });
      */
      System.import('app').then(function(app){
        console.log('app loaded', app)
          app.init({});
      }, function(err){console.log('error', err)});
    script(type="module").
      import {Character} from 'js/src/es6character';
      import {Flyweight as fly} from 'js/src/flyweight';

      var c = new Character('scooby doo');
      c.attack('Foo');
      //console.log('fly', fly)
    //
      case settings.env
        when 'production'
          script(src='/js/dist/#{settings.name}.prod.js')
        when 'development'
          script(src='/js/dist/#{settings.name}.dev.js')
        default
          script(src='/js/src/bower_components/requirejs/require.js', data-main="/js/src/config")
  body
    block content
